<!DOCTYPE html>
<html lang="zxx" class="js">

<head>
    <?php include('_meta.php') ?>
</head>

<body class="nk-body npc-crypto has-sidebar has-sidebar-fat ui-clean ">
    <div class="nk-app-root">
        <!-- main @s -->
        <div class="nk-main ">
            <?php include('_slidebare.php') ?>
            <!-- wrap @s -->
            <div class="nk-wrap ">
                <?php include('_header.php') ?>
                <!-- content @s -->

                <div class="nk-content nk-content-fluid">
                    <div class="container-xl wide-lg">
                        <div class="nk-content-body">
                              

                            <div class="align-center flex-wrap flex-md-nowrap g-4">
                                <div class="nk-block-image w-120px flex-shrink-0">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 118">
                                        <path d="M8.916,94.745C-.318,79.153-2.164,58.569,2.382,40.578,7.155,21.69,19.045,9.451,35.162,4.32,46.609.676,58.716.331,70.456,1.845,84.683,3.68,99.57,8.694,108.892,21.408c10.03,13.679,12.071,34.71,10.747,52.054-1.173,15.359-7.441,27.489-19.231,34.494-10.689,6.351-22.92,8.733-34.715,10.331-16.181,2.192-34.195-.336-47.6-12.281A47.243,47.243,0,0,1,8.916,94.745Z" transform="translate(0 -1)" fill="#f6faff"></path>
                                        <rect x="18" y="32" width="84" height="50" rx="4" ry="4" fill="#fff"></rect>
                                        <rect x="26" y="44" width="20" height="12" rx="1" ry="1" fill="#e5effe"></rect>
                                        <rect x="50" y="44" width="20" height="12" rx="1" ry="1" fill="#e5effe"></rect>
                                        <rect x="74" y="44" width="20" height="12" rx="1" ry="1" fill="#e5effe"></rect>
                                        <rect x="38" y="60" width="20" height="12" rx="1" ry="1" fill="#e5effe"></rect>
                                        <rect x="62" y="60" width="20" height="12" rx="1" ry="1" fill="#e5effe"></rect>
                                        <path d="M98,32H22a5.006,5.006,0,0,0-5,5V79a5.006,5.006,0,0,0,5,5H52v8H45a2,2,0,0,0-2,2v4a2,2,0,0,0,2,2H73a2,2,0,0,0,2-2V94a2,2,0,0,0-2-2H66V84H98a5.006,5.006,0,0,0,5-5V37A5.006,5.006,0,0,0,98,32ZM73,94v4H45V94Zm-9-2H54V84H64Zm37-13a3,3,0,0,1-3,3H22a3,3,0,0,1-3-3V37a3,3,0,0,1,3-3H98a3,3,0,0,1,3,3Z" transform="translate(0 -1)" fill="#798bff"></path>
                                        <path d="M61.444,41H40.111L33,48.143V19.7A3.632,3.632,0,0,1,36.556,16H61.444A3.632,3.632,0,0,1,65,19.7V37.3A3.632,3.632,0,0,1,61.444,41Z" transform="translate(0 -1)" fill="#6576ff"></path>
                                        <path d="M61.444,41H40.111L33,48.143V19.7A3.632,3.632,0,0,1,36.556,16H61.444A3.632,3.632,0,0,1,65,19.7V37.3A3.632,3.632,0,0,1,61.444,41Z" transform="translate(0 -1)" fill="none" stroke="#6576ff" stroke-miterlimit="10" stroke-width="2"></path>
                                        <line x1="40" y1="22" x2="57" y2="22" fill="none" stroke="#fffffe" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></line>
                                        <line x1="40" y1="27" x2="57" y2="27" fill="none" stroke="#fffffe" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></line>
                                        <line x1="40" y1="32" x2="50" y2="32" fill="none" stroke="#fffffe" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></line>
                                        <line x1="30.5" y1="87.5" x2="30.5" y2="91.5" fill="none" stroke="#9cabff" stroke-linecap="round" stroke-linejoin="round"></line>
                                        <line x1="28.5" y1="89.5" x2="32.5" y2="89.5" fill="none" stroke="#9cabff" stroke-linecap="round" stroke-linejoin="round"></line>
                                        <line x1="79.5" y1="22.5" x2="79.5" y2="26.5" fill="none" stroke="#9cabff" stroke-linecap="round" stroke-linejoin="round"></line>
                                        <line x1="77.5" y1="24.5" x2="81.5" y2="24.5" fill="none" stroke="#9cabff" stroke-linecap="round" stroke-linejoin="round"></line>
                                        <circle cx="90.5" cy="97.5" r="3" fill="none" stroke="#9cabff" stroke-miterlimit="10"></circle>
                                        <circle cx="24" cy="23" r="2.5" fill="none" stroke="#9cabff" stroke-miterlimit="10"></circle></svg>
                                </div>
                                <div class="nk-block-content">
                                    <div class="nk-block-content-head px-lg-4">
                                        <h5>Paramètrage radio</h5>
                                        <p class="text-soft">Les informations enregistrées dans cette section seront visible y compris le statut clobal de la radio dont le condition, le terme et la politique de confidentialité du site.</p>
                                    </div>
                                </div>
                                <div class="nk-block-content flex-shrink-0">
                                    <a href="javascript:void(0);" role="button" id="add_button" data-toggle="modal" data-target="#userModal" class="btn btn-lg btn-outline-primary">Enregistrez l'opération</a>
                                </div>
                            </div>  


                            <div class="align-center flex-wrap flex-md-nowrap g-4">

                            	<div class="col-lg-12 col-xs-12 col-md-12">
                            		<div class="table-responsive">

                            			<table id="user_data" class="table table-member">
                            				<thead class="tb-member-head thead-light">  
					                            <tr>  
					                                 <th width="10%">Image</th>  
					                                 <th width="15%">Nom</th>
					                                 <th width="15%">Email</th>
					                                 <th width="10%">A propos</th>
					                                 <th width="10%">Condition</th>
					                                 <th width="10%">Téléphone</th>
					                                 <th width="10%">Téléphone2</th>
					                                 <th width="10%">Adresse</th>
					                                 <th width="5%">Editer</th>  
					                                 <th width="5%">Del</th>  
					                            </tr>  
					                       </thead>  
                            			</table>
                            			
                            		</div>
                            	</div>


                            </div>  
                           
                            

                        </div>
                    </div>
                </div>


                
                <!-- content @e -->

                <?php include('_footer.php') ?>
                
            </div>
            <!-- wrap @e -->
        </div>
        <!-- main @e -->
    </div>
    <!-- app-root @e -->
    <!-- JavaScript -->


    <!-- modal ajout radio -->
    <div class="modal fade" tabindex="-1" role="dialog" id="userModal">
        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
            <div class="modal-content">
                <a href="#" class="close" data-dismiss="modal"><em class="icon ni ni-cross-sm"></em></a>
                <div class="modal-body modal-body-lg">
                    <div class="nk-block-head nk-block-head-xs text-center">
                        <span class="nk-block-title modal-title">Paramètrage radio</span>
                        
                    </div>
                    <div class="nk-block">

                    	<form method="post" id="user_form" enctype="multipart/form-data" class="col-md-12 row">
                    		
                    		<div class="col-md-6">
                    			<div class="input-group flex-nowrap mb-2">
          								  <div class="input-group-prepend">
          								    <span class="input-group-text" id="addon-wrapping"><i class="fa fa-pencil"></i></span>
          								  </div>
          								  <input type="text" name="nom_radio" id="nom_radio" class="form-control" placeholder="Nom de la radio" aria-label="nom de la rdio" aria-describedby="addon-wrapping">
          								</div>
                    		</div>

                    		<div class="col-md-6">
                    			<div class="input-group flex-nowrap mb-2">
          								  <div class="input-group-prepend">
          								    <span class="input-group-text" id="addon-wrapping"><i class="fa fa-envelope"></i></span>
          								  </div>
          								   <input type="email" name="email_radio" id="email_radio" class="form-control" placeholder="domaine@gmail.com" aria-label="email de la rdio" aria-describedby="addon-wrapping">
          								</div>
                    		</div>

                    		<div class="col-md-6">
                    			<div class="input-group flex-nowrap mb-2">
          								  <div class="input-group-prepend">
          								    <span class="input-group-text" id="addon-wrapping"><i class="fa fa-phone"></i></span>
          								  </div>
          								   <input type="text" name="telephone" id="telephone" class="form-control" placeholder="numéro de Téléphone de la rdio" aria-label="numéro de Téléphone de la rdio" aria-describedby="addon-wrapping">
          								</div>
                    		</div>

                    		<div class="col-md-6">
                    			<div class="input-group flex-nowrap mb-2">
          								  <div class="input-group-prepend">
          								    <span class="input-group-text" id="addon-wrapping"><i class="fa fa-phone"></i></span>
          								  </div>
          								   <input type="text" name="telephone2" id="telephone2" class="form-control" placeholder="deuxième numéro de Téléphone de la rdio" aria-label="numéro de Téléphone de la rdio" aria-describedby="addon-wrapping">
          								</div>
                    		</div>

                    		<div class="col-md-12">
                    			<div class="input-group flex-nowrap mb-2">
          								  <div class="input-group-prepend">
          								    <span class="input-group-text" id="addon-wrapping"><i class="fa fa-envelope"></i></span>
          								  </div>
          								   <textarea name="apropos_radio" id="apropos_radio" class="form-control" placeholder="A propos de la radio"></textarea>
          								</div>
                    		</div>

                    		<div class="col-md-12">
                    			<div class="input-group flex-nowrap mb-2">
          								  <div class="input-group-prepend">
          								    <span class="input-group-text" id="addon-wrapping"><i class="fa fa-book"></i></span>
          								  </div>
          								   <textarea name="condition_radio" id="condition_radio" class="form-control" placeholder="Condition et terme de la radio"></textarea>
          								</div>
                    		</div>

                    		<div class="col-md-12">
                    			<div class="input-group flex-nowrap mb-2">
          								  <div class="input-group-prepend">
          								    <span class="input-group-text" id="addon-wrapping"><i class="fa fa-map"></i></span>
          								  </div>
          								   <textarea name="adresse_radio" id="adresse_radio" class="form-control" placeholder="Adresse domicile de la radio"></textarea>
          								</div>
                    		</div>

                    		<div class="col-md-12">
                    			<div class="input-group flex-nowrap mb-2">
          								  <div class="input-group-prepend">
          								    <span class="input-group-text" id="addon-wrapping"><i class="fa fa-camera"></i></span>
          								  </div>
          								   <input type="file" name="user_image" id="user_image" class="form-control" placeholder="le logo de la rdio" aria-label="logo de la rdio" aria-describedby="addon-wrapping">
          								   
          								</div>
                    		</div>
                    		

                    		<div class="col-md-12">
                    			<div class="row">
                    				<div class="col-md-4"></div>
                    				<div class="col-md-4">

                    					<div class="buysell-field form-action text-center mb-2">
				                            <div>

				                            	<span class="text-center" id="user_uploaded_image"></span>
				                            </div>
				                           
				                        </div>
                    					
                    				</div>
                    				<div class="col-md-4"></div>
                    			</div>
                    			
                    		</div>

                    		<div class="col-md-12" style="margin-bottom: 20px;">
                    			<div class="row">
                    				<div class="col-md-4"></div>
                    				<div class="col-md-4">

                    					<div class="buysell-field form-action text-center mb-2">
				                            <div>

				                            	<input type="hidden" name="id_radio" id="id_radio" />  
			                    				<input type="submit" name="action" id="action" class="btn btn-primary btn-lg" value="Add" />
				                            </div>
				                            <div class="pt-3">
				                                <a href="javascript:void(0);" data-dismiss="modal" class="link link-danger">Annuler l'opération</a>
				                            </div>
				                        </div>
                    					
                    				</div>
                    				<div class="col-md-4"></div>
                    			</div>
                    		</div>





                    	</form>
                        
                        
                        
                    </div><!-- .nk-block -->
                </div><!-- .modal-body -->
            </div><!-- .modal-content -->
        </div><!-- .modla-dialog -->
    </div>
    <!-- fin modal-->




    <?php include('_script.php') ?>


    <script type="text/javascript" language="javascript" >  
 	 $(document).ready(function(){  
      $('#add_button').click(function(){  
           $('#user_form')[0].reset();  
           $('.modal-title').text("Paramètrage radio");  
           $('#action').val("Add");  
      });

      var dataTable = $('#user_data').DataTable({  
           "processing":true,  
           "serverSide":true,  
           "order":[],  
           "ajax":{  
                url:"<?php echo base_url() . 'admin/fetch_radio'; ?>",  
                type:"POST"  
           },  
           "columnDefs":[  
                {  
                     "targets":[0, 0, 0],  
                     "orderable":false,  
                },  
           ],  
      });

      $(document).on('submit', '#user_form', function(event){  
           event.preventDefault(); 
           var nom_radio 		= $('#nom_radio').val();
           var email_radio		= $('#email_radio').val();
           var apropos_radio 	= $('#apropos_radio').val();
           var condition_radio  = $('#condition_radio').val();
           var telephone 		= $('#telephone').val();
           var telephone2 		= $('#telephone2').val();
           var adresse_radio 	= $('#adresse_radio').val();
           var extension = $('#user_image').val().split('.').pop().toLowerCase(); 
           var action = $('#action').val();


           if(extension != '')  
           {  
                if(jQuery.inArray(extension, ['gif','png','jpg','jpeg']) == -1)  
                {  
                     // alert("Invalid Image File"); 
                     swal("Oups!!!", "erreur liée au format de logo", 'error');  
                     $('#user_image').val('');  
                     return false;  
                }  
           } 

           // alert(nom_radio+" "+action);


           if(nom_radio != '' && email_radio != '' && apropos_radio != '' && condition_radio != '' && telephone != '' && telephone2 != '' && adresse_radio != '')
            {

	            if (action =="Add") {
	                 
	                $.ajax({  
	                     url:"<?php echo base_url() . 'admin/insertion_radio'?>",  
	                     method:'POST',  
	                     data:new FormData(this),  
	                     contentType:false,  
	                     processData:false,  
	                     success:function(data)  
	                     {  
	                          swal("succès", ''+data, 'success');  
	                          $('#user_form')[0].reset();  
	                          $('#userModal').modal('hide');  
	                          dataTable.ajax.reload();  
	                     }  
	                });
	                  // alert("insertion");

	            }
		        else if (action == 'Edit') {
		        	$.ajax({  
                         url:"<?php echo base_url() . 'admin/modification_radio'?>",  
                         method:'POST',  
                         data:new FormData(this),  
                         contentType:false,  
                         processData:false,  
                         success:function(data)  
                         {  
                              swal("succès", ''+data, 'success');  
                              $('#user_form')[0].reset();  
                              $('#userModal').modal('hide');  
                              dataTable.ajax.reload();  
                         }  
                    });
	            }

            }
            else
            {
            	alert("Tous les champs doivent être remplis ");
            	// swal("Tous les champs doivent être remplis", "erreur", "alert-danger"); 
            }
             
      }); 

      $(document).on('click', '.update', function(){  
           var id_radio = $(this).attr("id_radio");  
           $.ajax({  
                url:"<?php echo base_url(); ?>admin/fetch_single_radio",  
                method:"POST",  
                data:{id_radio:id_radio},  
                dataType:"json",  
                success:function(data)  
                {  
                     $('#userModal').modal('show');  
                     $('#nom_radio').val(data.nom_radio);
                     $('#email_radio').val(data.email_radio);
                     $('#telephone').val(data.telephone);
                     $('#telephone2').val(data.telephone2);
                     $('#condition_radio').val(data.condition_radio);
                     $('#apropos_radio').val(data.apropos_radio);
                     $('#adresse_radio').val(data.adresse_radio);
                     $('#user_uploaded_image').html(data.user_image);

                     $('.modal-title').text("modification de la radio");  
                     $('#id_radio').val(id_radio);  
                     $('#action').val("Edit");  
                }  
           });  
      });

      $(document).on('click', '.delete', function(){
          var id_radio = $(this).attr("id_radio");

          	swal({
		        title: "Êtes-vous sûr?",
		        text: "Vous ne pourrez pas récupérer ces données provinciales!",
		        type: "warning",
		        showCancelButton: true,
		        confirmButtonColor: "#dc3545",
		        confirmButtonText: "Oui, supprimez-le!",
		        cancelButtonText: "Non, annulez!",
		        closeOnConfirm: false,
		        closeOnCancel: false
		    }, function (isConfirm) {
		        if (isConfirm) {

		        	$.ajax({
		              url:"<?php echo base_url(); ?>admin/supression_radio",
		              method:"POST",
		              data:{id_radio:id_radio},
		              success:function(data)
		              {
		                 swal("succès!", ''+data, "success");
		                 dataTable.ajax.reload();
		              }
		            });
		           
		        } else {
		            swal("Ouf!!!", "opération annulée :)", "error");
		        }
		    });
      });

	
 });  
 </script>

</body>

</html>